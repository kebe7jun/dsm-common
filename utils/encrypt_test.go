package utils

import (
	"github.com/stretchr/testify/assert"
	"testing"
)

func TestDSMEncrypt(t *testing.T) {
	assert.Equal(t, "c3R0ZQ==", DSMEncrypt("test"))
	assert.Equal(t, "t02nkbRPmJWURaeVlUI5NDEynKmaRpummEWUqJE4lKicLZGU", DSMEncrypt("6F8E4E7B-80D8-0DSM-0POC-0E411BC19412"))
	assert.Equal(t, `-----BEGIN PUBLIC KEY-----
MIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIICCgKCAgEA+QmB8qK49ub6iImADHAI
7+Iewb8cH9hn5TGS/GohE87Dc93QgfOTTEKh48CasBLLPDoRn90nowoatdyssrY0
hAbwOvBhr+qgcPQmMuOEIku0GElrNxoocjXxVYyrO5pgj/RtVWf96ONu0Jlr9zbU
kMLUJN+mFqP8c1oBsH4k/7khhFAD1ajWmhFx4gHOI91A3uYtBTnHrhtT+E5CscOO
LbypPBTZVcXI4hShGNM0Z2OkzcUHwkI32t1UN7jt/9k/up0cGKmU+Vad4Fa2QIvJ
gtm9EaDsdip3Vc3Ofqa7eUv+wniS15GR+3gbyk766i9h+v0rXbgYdktSnhWPfApu
BPFortUZRIOma+H4UvU/c+4uRr1cdIiYAKUwr4ui8aZegn4Umnc/XhjoVZxD3hjK
rgMd5cXhLOQpLe6ki8oSTKm6xoOacLXh9V+pXqpx4t+FBP3Vzav88VO+1x44WSrA
F/VhHOCUGSubYgJkeF6U9X8qvoegD9pcNAQ8bD9WjKWLihMuYnixIkJRjuvy1Cpf
bEluWmm0PX+Y9AkxmD2NlDnCSz5izBDyeyH6hGj7jztsv3bx4LaueonFSnR2BP8j
EI+JmdXwhrYQiFrpNEfyrqL1AiYN94Nv4mdr+hsGHKUo0uifVeqPnCVuo+TJB2Iz
wVpUmql8zzx1+WGKFpEcERsCAwEAAQ==
-----END PUBLIC KEY-----`,
		DSMDecrypt(DSMEncrypt(`-----BEGIN PUBLIC KEY-----
MIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIICCgKCAgEA+QmB8qK49ub6iImADHAI
7+Iewb8cH9hn5TGS/GohE87Dc93QgfOTTEKh48CasBLLPDoRn90nowoatdyssrY0
hAbwOvBhr+qgcPQmMuOEIku0GElrNxoocjXxVYyrO5pgj/RtVWf96ONu0Jlr9zbU
kMLUJN+mFqP8c1oBsH4k/7khhFAD1ajWmhFx4gHOI91A3uYtBTnHrhtT+E5CscOO
LbypPBTZVcXI4hShGNM0Z2OkzcUHwkI32t1UN7jt/9k/up0cGKmU+Vad4Fa2QIvJ
gtm9EaDsdip3Vc3Ofqa7eUv+wniS15GR+3gbyk766i9h+v0rXbgYdktSnhWPfApu
BPFortUZRIOma+H4UvU/c+4uRr1cdIiYAKUwr4ui8aZegn4Umnc/XhjoVZxD3hjK
rgMd5cXhLOQpLe6ki8oSTKm6xoOacLXh9V+pXqpx4t+FBP3Vzav88VO+1x44WSrA
F/VhHOCUGSubYgJkeF6U9X8qvoegD9pcNAQ8bD9WjKWLihMuYnixIkJRjuvy1Cpf
bEluWmm0PX+Y9AkxmD2NlDnCSz5izBDyeyH6hGj7jztsv3bx4LaueonFSnR2BP8j
EI+JmdXwhrYQiFrpNEfyrqL1AiYN94Nv4mdr+hsGHKUo0uifVeqPnCVuo+TJB2Iz
wVpUmql8zzx1+WGKFpEcERsCAwEAAQ==
-----END PUBLIC KEY-----`)))
	assert.Equal(t, `y728Yti3yGu7tNJo1NnKQbSqbkLYudNyrbO+Uo+s0WHauZhVj5iTY9aV2VKtzcdkr7m9QZjZ23LFvs040pjJZ9LHuW3MzpNYvtzTVszOqDPWy68KmcexZLCzvGiwybVwzZyaa7iv01Pc09E2x7CzYZ26vGi81Y9wmNjUeKa0j0bexZdWnLraOJXcsyu7t5g0bqrWQcysk1a5q7NDxr23dc/Jy0q5nao21dq8OMuo02XHsp1wnMalUbvOqDmwza9X2b3MTdyt0mm2zs9K3ZXZdspup3DQ2cZF0ZS7bY+9tFjP3J1BlrLRRNKn0ESZzbd6qN3eQqyayXnOm8xH2NfOesbc2jPF2ZhM0qrJb7aWt26czqZQrY9uRci8rm3Wvdtoqta1aanK1E7VsN1yzb2VQZiysjnRyNo0zNfWK6+5q0jZzdMwydXKVqe6tG6PuNlvlq2uQtu63grR1dRV3t7QOI+73DGq1KtLqbapY6Xb10OltalBbpGhPZGRkS2ohKlOprC0VYSvrUORkalZLS0tdpGRkS2pq5FChLStTrCtuUKvqacgkZG9LW6xkS2nra1JsqbOQdXMy2urnc9ppqXbMKqltUWnpaVPpbHLOKenrUmnpctLpY/LRaactW2YndVLms3ZYqWorW2tbqxBrcmbK5zH22LM0qw5q7eZVNPMk0ebqKk4l7XHObO4y2avzLhFp8WYOLCw10LTtrRElNLSOdPF03fd19hkvZTXcqXGbmjapttPj9XMcrS1y2PZs9FNz9mpSanQlEfc09ZOzrzTY73d3FaZ1NZPk7bLarvK2Fazsp02rtDZMN7G1jnPsbkKrrKwVarVj23HlbQ416zTQpObmGvMqs9olcWlRNHMzleYy6p4rZ2sT5fZlUGmuL101szSSI+p2FTXx5lDbrCzT9S0xnm+uqZUrZjHWMyrzFOUvrJNz96WT6zbx1WXls9JubLYMdiTm2qT2Z1rx6vUMLmPr23ImLphlrWqYa5urXbRnct0qNepYdSXyGmXs7pjxZvKcdqPyVXNt9tuq7aVNcvGjzObmt1rncyaaZTWjw==`,
		DSMEncrypt(`-----BEGIN PUBLIC KEY-----
MIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIICCgKCAgEA+QmB8qK49ub6iImADHAI
7+Iewb8cH9hn5TGS/GohE87Dc93QgfOTTEKh48CasBLLPDoRn90nowoatdyssrY0
hAbwOvBhr+qgcPQmMuOEIku0GElrNxoocjXxVYyrO5pgj/RtVWf96ONu0Jlr9zbU
kMLUJN+mFqP8c1oBsH4k/7khhFAD1ajWmhFx4gHOI91A3uYtBTnHrhtT+E5CscOO
LbypPBTZVcXI4hShGNM0Z2OkzcUHwkI32t1UN7jt/9k/up0cGKmU+Vad4Fa2QIvJ
gtm9EaDsdip3Vc3Ofqa7eUv+wniS15GR+3gbyk766i9h+v0rXbgYdktSnhWPfApu
BPFortUZRIOma+H4UvU/c+4uRr1cdIiYAKUwr4ui8aZegn4Umnc/XhjoVZxD3hjK
rgMd5cXhLOQpLe6ki8oSTKm6xoOacLXh9V+pXqpx4t+FBP3Vzav88VO+1x44WSrA
F/VhHOCUGSubYgJkeF6U9X8qvoegD9pcNAQ8bD9WjKWLihMuYnixIkJRjuvy1Cpf
bEluWmm0PX+Y9AkxmD2NlDnCSz5izBDyeyH6hGj7jztsv3bx4LaueonFSnR2BP8j
EI+JmdXwhrYQiFrpNEfyrqL1AiYN94Nv4mdr+hsGHKUo0uifVeqPnCVuo+TJB2Iz
wVpUmql8zzx1+WGKFpEcERsCAwEAAQ==
-----END PUBLIC KEY-----`))

	// DCE License Public key
	assert.Equal(t, `x65slNiaTJbNtlKnyL111661bbq71EOsstRunJqyQqjIlVTcu9VN0ri2UbDZvFWbs9RD0dWvQdLUmFRuj7ZDxsy6Y52PpTmV3Kxar6WWWcmdu2SVp75hzN7URNrKk2LMm7Nr3L7XZ5aVqEWw1sZOqcqPVKrMlEuptb1Jym6za9mot26t26g00piUWN3P10HV0c9Rm9KxeKyskzfTndhl3b2ZZ6iTy2/cmZ1jk9HeMb6plDSs3bxxzaizbqvPpWHbrW4xtaWoQZGRpgqRqZEthLSyRLCtuUKvqacgkZG9LS0tkZGRLamrkUKEtK1OsK25Qq+ppyCRkb0tbrGRLaatrUmyps5B1czLa6udz2mmpdswqqW1RaelpU+lsbU4pqetSaely0ul3LVFtrjFVsyqvXbSuNhpqKWcd9Zu3Fa52ad1vrq4c7ux2zHRqpNLsZiVU7u33Ue0zM1upd22TNKYzUzZrZlvq8vaTqmp0m6yuKVO3LjUQ7esk2PJu8ozs9ZuY6+pyFfGnZp11q2tRcfO3Weoy7k3mJu+bc/d1FXR3bsxy7GwVbmmj0uXp5tG2o+ZcLWPtmi+vtUwnNK1Q7XGmQq5`,
		DSMEncrypt(`-----BEGIN PUBLIC KEY-----
MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAxaVRTYvhFtinT8wDAxVr
CuUuTsZVw1WM/KmF1SM4yGWSinPhRLAyiLn45ouIvNGgnnEEANNTpCxT/cSHf3eW
cOrdWKE6ub9IErIygcjU7DgZm47pUkyW1myLUgM+KUB7F3C5pv+RhQ+q0ZZQC8n5
QbJlUc6L0tRR2iYuCdQmsJpCVWpnHNNB861TDdqMxWRQnTXULupC7OKAmq4TnpRC
+VcbhA99+HZ1x2YKAWde9Za1CpDhz/bvfOkh7sgxZDE21bNLr+TEf0KFhYIEQOkf
SnuDD4Iw0Xn4sAykkQqmMx7n/7HHteo95gyYgoD/9cx5z1/m04ZEXqHyOniDAaGk
1wIDAQAB
-----END PUBLIC KEY-----`))
	assert.Equal(t, "test", DSMDecrypt(DSMEncrypt("test")))
	assert.Equal(t, "", DSMDecrypt(DSMEncrypt("")))
}
